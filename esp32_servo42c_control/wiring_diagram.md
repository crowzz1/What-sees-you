# MKS-SERVO42C 与 ESP32 接线图

## 基本接线

### 单电机接线

```
ESP32                    SERVO42C
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
GPIO17 (TX2) ---------> RX
GPIO16 (RX2) <--------- TX
GND         ----------- GND

电源:
7-28V DC    ----------> SERVO42C 电源输入
                        (使用独立电源)
```

### 双电机接线

```
ESP32                    SERVO42C #1
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
GPIO26 (TX1) ---------> RX
GPIO25 (RX1) <--------- TX
GND         ----------- GND

ESP32                    SERVO42C #2
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
GPIO17 (TX2) ---------> RX
GPIO16 (RX2) <--------- TX
GND         ----------- GND

电源:
7-28V DC    ----------> SERVO42C #1 电源
7-28V DC    ----------> SERVO42C #2 电源
                        (可共用电源，但要注意电流)
```

## ESP32 可用串口引脚

ESP32 有 3 个硬件 UART：

### UART0 (Serial)
- 默认用于 USB 调试
- TX: GPIO1
- RX: GPIO3
- **建议：保留作为调试串口**

### UART1 (Serial1)
- TX: GPIO10 (默认，但某些板子可能占用)
- RX: GPIO9 (默认，但某些板子可能占用)
- **推荐使用其他 GPIO 重映射：**
  - TX: GPIO26
  - RX: GPIO25

### UART2 (Serial2)
- TX: GPIO17 (默认)
- RX: GPIO16 (默认)
- **推荐直接使用默认引脚**

### 其他可用 GPIO 引脚
- GPIO 4, 5, 12, 13, 14, 15, 27, 32, 33
- 建议避免使用：GPIO 0, 2, 6-11 (部分板子有特殊用途)

## SERVO42C 引脚说明

### 控制接口
```
SERVO42C 端子
┏━━━━━━━━━━━━┓
┃ GND  TX  RX ┃  ← 串口通信
┗━━━━━━━━━━━━┛
```

### 电源接口
```
SERVO42C 电源端子
┏━━━━━━━━━━━━┓
┃  +   GND  - ┃  ← 7-28V DC
┗━━━━━━━━━━━━┛
```

### 电机接口
```
SERVO42C 电机端子
┏━━━━━━━━━━━━━━━━┓
┃ A+  A-  B+  B- ┃  ← 连接步进电机
┗━━━━━━━━━━━━━━━━┛
```

## 完整系统接线示例（4轴机械臂）

如果需要控制 4 个或更多电机，建议使用以下方案之一：

### 方案1：多个 ESP32
```
ESP32 #1 (主控) --+-- SERVO42C #1 (基座)
                  +-- SERVO42C #2 (大臂)

ESP32 #2 (从控) --+-- SERVO42C #3 (小臂)
                  +-- SERVO42C #4 (手腕)

ESP32 之间通过 I2C/SPI/UART 通信
```

### 方案2：RS485 总线
```
ESP32 --> RS485 转换器 --> RS485 总线
                           |
                           +-- SERVO42C #1
                           +-- SERVO42C #2
                           +-- SERVO42C #3
                           +-- SERVO42C #4

注意：需要 SERVO42C 支持 RS485 或使用转换模块
```

### 方案3：串口扩展板
```
ESP32 --> UART 扩展芯片 (如 SC16IS752) --> 多路 UART
          (通过 I2C/SPI 控制)              |
                                           +-- SERVO42C #1
                                           +-- SERVO42C #2
                                           +-- SERVO42C #3
                                           +-- SERVO42C #4
```

## 电源注意事项

### 重要提示
1. **ESP32 和 SERVO42C 必须共地 (GND 连接)**
2. **不要将 ESP32 的 5V/3.3V 连接到 SERVO42C**
3. **SERVO42C 需要独立的 7-28V 电源**

### 推荐电源配置

对于单电机系统：
```
24V 电源适配器 (≥2A)
├─> SERVO42C (24V)
└─> ESP32 (通过 USB 或 5V 稳压模块)
```

对于多电机系统：
```
24V 开关电源 (根据电机数量选择功率，建议每个电机 2-3A)
├─> SERVO42C #1 (24V)
├─> SERVO42C #2 (24V)
├─> SERVO42C #3 (24V)
├─> SERVO42C #4 (24V)
└─> DC-DC 降压模块 -> ESP32 (5V/3.3V)
```

### 电流估算
- 单个 SERVO42C 运行电流：0.5-3A (取决于负载)
- 峰值电流：可能达到 3A
- 建议电源余量：1.5-2 倍

## 接线检查清单

- [ ] ESP32 与 SERVO42C 串口连接正确 (TX->RX, RX->TX)
- [ ] 所有 GND 已连接
- [ ] SERVO42C 电源电压正确 (7-28V)
- [ ] ESP32 电源独立供电
- [ ] 电机已正确连接到 SERVO42C
- [ ] 接线牢固，无短路
- [ ] 电源极性正确 (+/-)

## 调试技巧

1. **先测试单个电机**
   - 确保一个电机能正常工作后再添加更多

2. **使用万用表检查**
   - 测量 SERVO42C 电源电压
   - 确认 GND 连接

3. **串口调试**
   - 使用 USB-TTL 转换器直接连接 SERVO42C
   - 在电脑上测试命令

4. **LED 指示**
   - 观察 SERVO42C 上的 LED 状态
   - 参考用户手册了解 LED 含义

## 安全警告

⚠️ **警告**
- 调试时使用较低电压和电流
- 确保机械臂有足够的活动空间
- 添加紧急停止按钮
- 不要在运动过程中触碰机械臂
- 首次使用时慢速测试




